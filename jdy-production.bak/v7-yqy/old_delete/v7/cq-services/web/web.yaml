apiVersion: apps/v1
kind: Deployment
metadata:
#  annotations:
#    com.kingdee.kcs.clusterenv: ""
#    com.kingdee.kcs.deploytime: "1585037641"
#    deployment.kubernetes.io/revision: "1"
#  creationTimestamp: "2020-03-24T08:14:01Z"
#  generation: 1
  labels:
  #  cluster: clustername
    app: web
  name: web
  namespace: ns-v7yqy
#  resourceVersion: "138511"
#  selfLink: /apis/extensions/v1beta1/namespaces/clustername/deployments/web
#  uid: 6b65ecdc-6da7-11ea-ab79-08002792b40b
spec:
#  progressDeadlineSeconds: 600
  replicas: 1
#  revisionHistoryLimit: 2
  selector:
    matchLabels:
      app: web
#      cluster: clustername
#      sname: web
  strategy:
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
    type: RollingUpdate
  template:
    metadata:
#      annotations:
#        com.kingdee.kcs.zid: "5"
#      creationTimestamp: null
      labels:
        app: web
#        cluster: clustername
#        sname: web
    spec:
      serviceAccountName: sa-v7yqy
      containers:
      - env:
        - name: clusterName
          value: v7yqy001
        - name: configUrl
          value: 10.190.2.34:2181,10.190.2.37:2181,10.190.2.50:2181
        - name: appName
          value: web
        - name: configAppName
          value: web
        - name: WEB_PORT
          value: "8080"
        - name: ENABLE_JETTY
          value: "true"
        - name: appSplit
          value: "false"
        - name: APPSTORE_URL
          value: http://10.190.2.50:8090/appstore/cosmic
        - name: BOSLIBS
          value: bos.xml,bos-qing
        - name: BIZLIBS
          value: bizweb.xml
        - name: TRDLIBS
          value: trd.xml,trd-qing
        - name: JVM_OPTS
          value: -server -Xms2048m -Xmx2048m -XX:MaxMetaspaceSize=1024m -XX:NativeMemoryTracking=summary
            -Duser.timezone=GMT+8 -Dfile.encoding=UTF-8 -DSchedule.disableToWork=true -XX:+PrintGCApplicationStoppedTime
            -XX:+DisableExplicitGC -XX:+UseG1GC -XX:+PrintAdaptiveSizePolicy -XX:+PrintGCDetails
            -XX:+PrintGCDateStamps -Xloggc:../logs/gc.%t.log
        image: kcr.kingdee.com/support/v2.0/mservice:v-20191220
        imagePullPolicy: IfNotPresent
        livenessProbe:
          failureThreshold: 3
          initialDelaySeconds: 600
          periodSeconds: 10
          successThreshold: 1
          tcpSocket:
            port: 8080
          timeoutSeconds: 3
        name: web
        ports:
        - containerPort: 8080
          protocol: TCP
        readinessProbe:
          failureThreshold: 3
          initialDelaySeconds: 30
          periodSeconds: 10
          successThreshold: 1
          tcpSocket:
            port: 8080
          timeoutSeconds: 3
        resources:
          limits:
            cpu: "2"
            memory: 4Gi
          requests:
            cpu: 800m
            memory: 4Gi
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
        - mountPath: /etc/localtime
          name: v-015850376410
          readOnly: true
      dnsPolicy: ClusterFirst
      restartPolicy: Always
#      schedulerName: default-scheduler
#      securityContext: {}
#      terminationGracePeriodSeconds: 30
      volumes:
      - hostPath:
          path: /etc/localtime
          type: ""
        name: v-015850376410
      nodeSelector:
        cq: v7yqy
